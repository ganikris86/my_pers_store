doctype html
head
  title My Pers | Store
  //Google tag (gtag.js) -- START
  script(async src='https://www.googletagmanager.com/gtag/js?id=G-X8JT2JDNXR')
  script.
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-X8JT2JDNXR');
  //Google tag (gtag.js) -- END

  //Google Tag Manager - START
  script.
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WH4QTVXL');
  //Google Tag Manager - END

body
//Google Tag Manager - START
noscript 
  iframe(src='https://www.googletagmanager.com/ns.html?id=GTM-WH4QTVXL', height='0', width='0', style='display:none;visibility:hidden')
//Google Tag Manager - END
.content
  header
    h1.title My Pers | Store
    .cart
      | Items In Cart:
      input#cart-items(type='number' width='10' height='10' value='0')
  container
    div
      | Logged in as email@example.com
  table
    tr
      td
        .box
          .item-title-1 Product 1
          .item-product-id-1 Product ID: 5678AB
          .item-price-1 $29.99
          button(onclick="viewContent('Product 1','5678AB',29.99)") View Content Details
          button#add-to-cart-button-1(onclick="addToCart('Product 1','5678AB',29.99)") Add To Cart
      td
        .box
          .item-title-2 Product 2
          .item-product-id-2 Product ID: 6521FJ
          .item-price-2 $49.99
          button(onclick="viewContent('Product 2','6521FJ',49.99)") View Content Details
          button#add-to-cart-button-2(onclick="addToCart('Product 2','6521FJ',49.99)") Add To Cart
      td
        .box
          .item-title-3 Product 3
          .item-product-id-2 Product ID: 4098MD
          .item-price-2 $199.99
          button(onclick="viewContent('Product 3','4098MD',199.99)") View Content Details
          button#add-to-cart-button-3(onclick="addToCart('Product 3','4098MD',199.99)") Add To Cart
  button.checkout(onclick="initiateCheckout('Product 3','4098MD',199.99)") Initiate Checkout
  footer
// BEGIN TIKTOK PIXEL EVENT FUNCTIONS SCRIPT SECTION
script.
  // BEGIN DO NOT EDIT SECTION
  //completeRegistration();
  // END DO NOT EDIT SECTION
  function completeRegistration() {
      // BEGIN DO NOT EDIT SECTION
      alert("Required Registration Step" +
      "\\n" + "Email address provided is email@example.com");
      alert("Required Registration Step" +
      "\\n" + "Phone number provided +15551234567");
      var phone = "+15551234567";
      var email = "email@example.com";
      console.log("email: " + email);
      console.log("phone: " + phone);
      // END DO NOT EDIT SECTION
  }
  function addToCart(title, productId, price) {
      //GTAG - Publish eComm event - AddToCart
      //- gtag("event", "add_to_cart", {
      //-         value: price,
      //-         currency: "AUD",
      //-         items: [
      //-         // If someone purchases more than one item, 
      //-         // you can add those items to the items array
      //-         {
      //-           item_id: productId,
      //-           item_name: title,
      //-           item_brand: "Brand_1",
      //-           price: price,
      //-           quantity: 1
      //-         }]
      //-     });
      //GTM - Push to data layer
      dataLayer.push({ ecommerce: null });  // Clear the previous ecommerce object.
      dataLayer.push({
        event: "add_to_cart",
        event_id: Math.floor(Math.random() * 9000000000) + 1000000000,
        ecommerce: {
          currency: "AUD",
          value: price,
          items: [
          {
            item_id: productId,
            item_name: title,
            item_brand: "Brand_1",
            price: price,
            quantity: 1
          }
          ]
        }
      });  
      // BEGIN HINT: UTILIZE THESE VARIABLES WHEN CONSTRUCTING YOUR CORRESPONDING TIKTOK PIXEL EVENTS
      console.log("addToCart Function")
      console.log("title:" + " " + title);
      console.log("price:" + " " + price);
      console.log("productId:" + " " + productId);
      // END HINT: UTILIZE THESE VARIABLES WHEN CONSTRUCTING YOUR CORRESPONDING TIKTOK PIXEL EVENTS
      // BEGIN DO NOT EDIT SECTION
      if (title == "Product 1") {
      document.getElementById("add-to-cart-button-1").disabled = 'true';
      } else if (title == "Product 2") {
      document.getElementById("add-to-cart-button-2").disabled = 'true';
      } else if (title == "Product 3") {
      document.getElementById("add-to-cart-button-3").disabled = 'true';
      }
      document.getElementById("cart-items").stepUp();
      // END DO NOT EDIT SECTION
  }
  function viewContent(title, productId, price) {
      //GTAG - Publish eComm event - ViewContent
      //- gtag("event", "view_item", {
      //-         value: price,
      //-         currency: "AUD",
      //-         items: [
      //-         // If someone purchases more than one item, 
      //-         // you can add those items to the items array
      //-         {
      //-           item_id: productId,
      //-           item_name: title,
      //-           item_brand: "Brand_1",
      //-           price: price
      //-         }]
      //-     });
      //GTM - Push to data layer
      dataLayer.push({ ecommerce: null });  // Clear the previous ecommerce object.
      dataLayer.push({
        event: "view_item",
        event_id: Math.floor(Math.random() * 9000000000) + 1000000000,
        ecommerce: {
          currency: "AUD",
          value: price,
          items: [
          {
            item_id: productId,
            item_name: title,
            item_brand: "Brand_1",
            price: price
          }
          ]
        }
      });
      // BEGIN DO NOT EDIT SECTION
      alert("Mock Product Item Details Popup: "
      + "\\n" + "title: " + title
      + "\\n" + "price: " + price
      + "\\n" + "productId: " +  productId)
      // END DO NOT EDIT SECTION
      // BEGIN HINT: UTILIZE THESE VARIABLES WHEN CONSTRUCTING YOUR CORRESPONDING TIKTOK PIXEL EVENT
      console.log("viewContent Function")
      console.log("title:" + " " + title);
      console.log("price:" + " " + price);
      console.log("productId:" + " " + productId);
      // END HINT: UTILIZE THESE VARIABLES WHEN CONSTRUCTING YOUR CORRESPONDING TIKTOK PIXEL EVENT
  }
  function registrationComplete(email, phone) {
      // BEGIN HINT: UTILIZE THESE VARIABLES WHEN CONSTRUCTING YOUR CORRESPONDING TIKTOK PIXEL EVENT
      console.log("registrationComplete Function")
      console.log("email:" + " " + email);
      console.log("phonenumber:" + " " + phone);
      // END HINT: UTILIZE THESE VARIABLES WHEN CONSTRUCTING YOUR CORRESPONDING TIKTOK PIXEL EVENT
      // BEGIN DO NOT EDIT SECTION
      alert("Registration Complete");
      // END DO NOT EDIT SECTION
  }
  function initiateCheckout(title, productId, price) {
      //GTAG - Publish eComm event - InitiateCheckout
      //- gtag("event", "begin_checkout", {
      //-         value: price,
      //-         currency: "AUD",
      //-         items: [
      //-         // If someone purchases more than one item, 
      //-         // you can add those items to the items array
      //-         {
      //-           item_id: productId,
      //-           item_name: title,
      //-           item_brand: "Brand_1",
      //-           price: price,
      //-           quantity: 1
      //-         }]
      //-     });
      //GTM - Push to data layer
      dataLayer.push({ ecommerce: null });  // Clear the previous ecommerce object.
      dataLayer.push({
        event: "begin_checkout",
        event_id: Math.floor(Math.random() * 9000000000) + 1000000000,
        ecommerce: {
          currency: "AUD",
          value: price,
          items: [
          {
            item_id: productId,
            item_name: title,
            item_brand: "Brand_1",
            price: price,
            quantity: 1
          }
          ]
        }
      });
      var retVal = confirm("This is a pop up meant to be a mock initiate checkout step - clicking OK will assume that the correct payment information was entered by the customer. Purchase will then complete successfully. HINT: Clicking Cancel should not trigger any events");
      if (retVal === true) {
      // BEGIN DO NOT EDIT SECTION
      completePayment(title, productId, price);
      } else {
      alert("Payment step cancelled!");
      return false;
      }
      // END DO NOT EDIT SECTION
  }
  // HINT: This is the dedicated function for Complete Payment
  function completePayment(title, productId, price) {
    //GTAG - Publish eComm event - CompletePayment
    //- gtag("event", "purchase", {
    //-         value: price,
    //-         currency: "AUD",
    //-         items: [
    //-         // If someone purchases more than one item, 
    //-         // you can add those items to the items array
    //-         {
    //-           item_id: productId,
    //-           item_name: title,
    //-           item_brand: "Brand_1",
    //-           price: price,
    //-           quantity: 1
    //-         }]
    //-     });
    //GTM - Push to data layer
    dataLayer.push({ ecommerce: null });  // Clear the previous ecommerce object.
    dataLayer.push({
      event: "purchase",
      event_id: Math.floor(Math.random() * 9000000000) + 1000000000,
      ecommerce: {
        currency: "AUD",
        value: price,
        items: [
        {
          item_id: productId,
          item_name: title,
          item_brand: "Brand_1",
          price: price,
          quantity: 1
        }
        ]
      },
      email: "48ddb93f0b30c475423fe177832912c5bcdce3cc72872f8051627967ef278e08"
    });
  // BEGIN DO NOT EDIT SECTION
  alert("Payment Completed - Purchase Successful")
  // END DO NOT EDIT SECTION
  }
// END TIKTOK PIXEL EVENT FUNCTIONS SCRIPT SECTION
// BEGIN STYLING SECTION - DO NOT EDIT
style(type='text/css').
  h1 + div {padding-left: 370px;
  }
  div {padding: 10px;
  }
  table {padding-bottom: 20px;
  }
  footer {padding: 10px;
  }
  .box {box-sizing: content-box;    width: 200px;height: 180px;padding: 20px;    border: 2px solid black;text-align: center;
  }
  .cart {		float: right;
  }
  .content {max-width: 800px;margin: auto;
  }
  .title {display: inline-block;
  }
  #cart-items {border: 0;
  }
// END STYLING SECTION - DO NOT EDIT
